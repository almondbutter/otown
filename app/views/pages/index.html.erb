<h2>Destination Oneonta</h2><h3>Events listing source for Oneonta, NY</h3>
<% if current_user.present? %>
  <%= link_to "Add an Event", new_link_path %>
  <% @links.each do |link| %>
    <li><%= link_to link.title, link %></li>
    <%= link_to "comments", link %>
    Votes: <%= link.votes.where(:up => true).count - link.votes.where(:up => false).count %>
    <% if current_user && current_user.votes.where(:link_id => link.id, :up => true).present? %>
    *
    <% else %>
      <%= link_to "+", votes_path(:vote => {:link_id => link.id, :up => true}), :method => :post %>
    <% end %>
    <% if current_user && current_user.votes.where(:link_id => link.id, :up => false).present? %>
    *
    <% else %>
      <%= link_to "-", votes_path(:vote => {:link_id => link.id, :up => false}), :method => :post %>
    <% end %>
  <% end %>
 </ul>
<%= will_paginate @links %>
<% else %>
  <%= link_to "New User?", new_user_registration_path %>
 <ul>
  <% @links.each do |link| %>
    <li><%= link_to link.title, link %></li>
    <%= link_to "comments", link %>
    Votes: <%= link.votes.where(:up => true).count - link.votes.where(:up => false).count %>
    <% if current_user && current_user.votes.where(:link_id => link.id, :up => true).present? %>
    *
    <% else %>
      <%= link_to "+", votes_path(:vote => {:link_id => link.id, :up => true}), :method => :post %>
    <% end %>
    <% if current_user && current_user.votes.where(:link_id => link.id, :up => false).present? %>
    *
    <% else %>
      <%= link_to "-", votes_path(:vote => {:link_id => link.id, :up => false}), :method => :post %>
    <% end %>
    <li class="traffic_data">
            <%= pluralize(link.votes.where(:up => true).count, "vote") %> |
            <%= link_to "#{pluralize(link.comments.count, "comment")}", link %>
    </li>
  <% end %>
 </ul>

 <%= will_paginate @links %>
 <% end %>
